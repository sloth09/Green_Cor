# Stochastic Analysis Configuration
# Configuration for vessel distribution scenarios and Monte Carlo parameters

# ============================================================================
# VESSEL DISTRIBUTION - 선박 크기(급유량) 분포
# ============================================================================
vessel_distribution:
  # 선박 유형별 급유량 범위 (공통, 모든 시나리오에서 사용)
  types:
    small:
      min_volume: 1000      # m3
      max_volume: 2500      # m3
      mean_volume: 1500     # m3
      std_volume: 300       # for normal distribution sampling
    medium:
      min_volume: 2500
      max_volume: 6000
      mean_volume: 4000
      std_volume: 700
    large:
      min_volume: 6000
      max_volume: 15000
      mean_volume: 10000
      std_volume: 2000

  # Multiple Distribution Scenarios (선박 믹스 시나리오)
  distribution_scenarios:
    high_large:
      name: "Large Vessel Dominated"
      description: "대형선 비율이 높은 시나리오 (컨테이너 허브항 특성)"
      small_share: 0.15      # 15%
      medium_share: 0.35     # 35%
      large_share: 0.50      # 50%
      probability: 0.25      # 이 시나리오가 발생할 확률 (Stochastic 분석용)

    balanced:
      name: "Balanced Mix"
      description: "균형잡힌 선박 믹스 (기준 시나리오)"
      small_share: 0.30      # 30%
      medium_share: 0.50     # 50%
      large_share: 0.20      # 20%
      probability: 0.50      # 기준 시나리오에 높은 확률 부여

    high_small:
      name: "Small Vessel Dominated"
      description: "소형선 비율이 높은 시나리오 (피더선 중심 항만)"
      small_share: 0.50      # 50%
      medium_share: 0.40     # 40%
      large_share: 0.10      # 10%
      probability: 0.25      # 이 시나리오가 발생할 확률

  # 기본 시나리오 (단일 시나리오 분석 시 사용)
  default_scenario: "balanced"

# ============================================================================
# MONTE CARLO SAMPLING PARAMETERS
# ============================================================================
sampling:
  # Monte Carlo 시나리오 수
  n_monte_carlo: 100         # 개발/테스트용: 100, 논문용: 500-1000

  # 난수 시드 (재현성 보장)
  random_seed: 42

  # 샘플링 방법
  method: "discrete"         # discrete (이산), continuous (연속)

  # 연속 분포 사용 시 분포 유형
  continuous_distribution: "truncated_normal"  # truncated_normal, lognormal, uniform

# ============================================================================
# DEMAND UNCERTAINTY - 수요 불확실성
# ============================================================================
demand_uncertainty:
  enabled: true

  # 연간 수요 변동성 (coefficient of variation)
  annual_cv: 0.15           # 15% 변동성

  # 수요 성장률 불확실성
  growth_rate_uncertainty:
    enabled: true
    min_multiplier: 0.8     # 기준 대비 80% (비관적)
    max_multiplier: 1.2     # 기준 대비 120% (낙관적)

# ============================================================================
# FUEL PRICE UNCERTAINTY - 연료 가격 불확실성
# ============================================================================
fuel_price_uncertainty:
  enabled: true

  # 기준 가격: economy.fuel_price_usd_per_ton (base.yaml에서)
  # 변동 범위
  min_multiplier: 0.7       # -30%
  max_multiplier: 1.3       # +30%

  # 가격 변동 모델
  model: "gbm"              # gbm (Geometric Brownian Motion), uniform
  annual_volatility: 0.15   # GBM 연간 변동성

# ============================================================================
# ANALYSIS OUTPUTS
# ============================================================================
outputs:
  # 분석 결과 저장 위치
  output_directory: "results/stochastic"

  # 출력 포맷
  formats:
    csv: true
    excel: true
    plots: true             # matplotlib 그래프 생성

  # 저장할 통계량
  statistics:
    - mean
    - std
    - min
    - max
    - percentile_5
    - percentile_25
    - percentile_50
    - percentile_75
    - percentile_95

# ============================================================================
# STOCHASTIC OPTIMIZATION SETTINGS
# ============================================================================
stochastic_optimization:
  # Two-Stage Stochastic Programming 설정

  # 1st stage decisions (불확실성 실현 전)
  first_stage_decisions:
    - shuttle_size          # 셔틀 크기 선택
    - pump_size             # 펌프 용량 선택
    - initial_fleet_size    # 초기 함대 크기

  # 2nd stage decisions (불확실성 실현 후, 시나리오별)
  second_stage_decisions:
    - annual_fleet_additions  # 연간 함대 추가
    - operational_intensity   # 운영 강도

  # Risk measure
  risk_measure: "expected_value"  # expected_value, cvar_95

  # CVaR 설정 (risk_measure = "cvar" 일 때)
  cvar:
    alpha: 0.95             # 95% CVaR

  # 솔버 설정
  solver:
    time_limit_seconds: 300  # 최대 풀이 시간
    gap_tolerance: 0.01      # 1% optimality gap 허용

# ============================================================================
# SENSITIVITY ANALYSIS PARAMETERS
# ============================================================================
sensitivity_analysis:
  # 분석 대상 파라미터
  parameters:
    - path: "economy.fuel_price_usd_per_ton"
      name: "Fuel Price"
      variations: [-0.30, -0.20, -0.10, 0, 0.10, 0.20, 0.30]

    - path: "operations.max_annual_hours_per_vessel"
      name: "Max Annual Hours"
      variations: [-0.125, 0, 0.095]  # 7000, 8000, 8760

    - path: "vessel_distribution.distribution_scenarios.balanced.large_share"
      name: "Large Vessel Share"
      variations: [0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40]
      type: "absolute"  # absolute (절대값), relative (상대값)

    - path: "operations.travel_time_hours"
      name: "Travel Time"
      variations: [-0.20, -0.10, 0, 0.10, 0.20]

  # Tornado diagram 설정
  tornado:
    base_variation: 0.10    # ±10%

# ============================================================================
# BREAK-EVEN ANALYSIS PARAMETERS
# ============================================================================
breakeven_analysis:
  # Case 1 vs Case 2 손익분기 분석

  # 거리 기반 분석
  distance:
    enabled: true
    range: [10, 100]        # 해리 (nautical miles)
    step: 5

  # 수요 기반 분석
  demand:
    enabled: true
    range: [50, 500]        # 연간 선박 수
    step: 25

  # 대형선 비율 기반 분석
  large_vessel_share:
    enabled: true
    range: [0.10, 0.50]     # 10% ~ 50%
    step: 0.05
