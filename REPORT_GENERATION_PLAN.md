# Report Generation Plan: v2.4 Optimal Solutions Analysis

**Objective**: Document the v2.4 optimal solutions across all three cases with structured 3-layer analysis reports.
**Version**: v2.4 (No Discounting, Annualized CAPEX)
**Executor**: Claude Code (AI Agent)
**Tools**: `visualization_generator.py` (for figures), Markdown (for text/tables)

---

## 1. Report Structure (3-Layer Pyramid)

The report will be divided into three hierarchical layers in `docs/analysis/case_1/`.

### Layer 1: Executive Summary (All 3 Cases)
- **File**: `docs/analysis/EXECUTIVE_SUMMARY.md`
- **Target Audience**: Decision Makers (CEO/Executives)
- **Goal**: Provide the optimal decisions for all three cases and key warnings in < 5 minutes.
- **Key Content**:
    - **Case 1**: Optimal Scenario (2500m³ Shuttle × 2000m³/h Pump)
    - **Case 2-2**: Optimal Scenario (5000m³ Shuttle × 2000m³/h Pump)
    - **Case 2-1**: Optimal Scenario (10000m³ Shuttle × 2000m³/h Pump)
    - Top 5 Scenarios Comparison Table (All Cases)
    - "What to Avoid" (Worst 3 Scenarios)
    - Economic Comparison (Case-by-case NPC analysis)

### Layer 2: Strategic Analysis (All 3 Cases)
- **Files**: `docs/analysis/Ch5_Case1_Analysis.md`, `docs/analysis/Ch6_Case2_Analysis.md`
- **Target Audience**: Project Managers / Strategists
- **Goal**: Explain *why* each optimal choice is best using trade-off analysis and comparative metrics.
- **Key Content**:
    - **Case 1**: Why 2500m³ shuttle + 2000m³/h pump is optimal
    - **Case 2-2**: Why 5000m³ shuttle + 2000m³/h pump is optimal (vs Case 1)
    - **Case 2-1**: Why 10000m³ shuttle + 2000m³/h pump is optimal (vs Case 2-2)
    - Shuttle Size Trade-off Analysis (per case)
    - Pump Speed Trade-off Analysis (per case)
    - Distance Impact on Economics

### Layer 3: Technical Details
- **File**: `TECHNICAL_DETAILS.md`
- **Target Audience**: Engineers / Analysts
- **Goal**: Provide proof through detailed breakdown of time and costs.
- **Key Content**:
    - Cycle Time Breakdown (Step-by-step timing)
    - Cost Structure (CAPEX vs OPEX)
    - Fleet Expansion Plan (Year-by-year)

---

## 2. v2.4 Optimal Solutions Summary

| Case | Optimal Shuttle | Optimal Pump | Total NPC (20Y) | LCOA | Cycle Time |
|------|-----------------|--------------|-----------------|------|-----------|
| **Case 1** (Busan Storage) | 2,500 m³ | 2,000 m³/h | ~$XXM | ~$XXX/ton | ~11.3h |
| **Case 2-2** (Ulsan→Busan) | 5,000 m³ | 2,000 m³/h | ~$YYM | ~$YYY/ton | ~28.3h |
| **Case 2-1** (Yeosu→Busan) | 10,000 m³ | 2,000 m³/h | ~$ZZM | ~$ZZZ/ton | ~36h |

**Note**: All cases use Pump Size = 2000 m³/h (consistent optimal). Case differences driven by Shuttle Size and Distance.

## 3. Required Tables List

### For EXECUTIVE_SUMMARY.md (All Cases)
| Table ID | Name | Data Source |
|----------|------|-------------|
| **T1.1** | **Optimal Scenarios Snapshot (All 3 Cases)** | `MILP_scenario_summary_case_*.csv` (Best Row per case) |
| **T1.2** | **Top 5 Scenarios per Case** | `MILP_scenario_summary_case_*.csv` (Top 5 per case) |
| **T1.3** | **Case Comparison (Cost, Size, Cycle Time)** | `MILP_scenario_summary_case_*.csv` (Best Row per case) |

### For Strategic Analysis (Ch5, Ch6 Markdown Files)
| Section | Name | Data Source |
|---------|------|-------------|
| **Ch5.1-1** | **Case 1 Optimal Decision** | `MILP_scenario_summary_case_1.csv` (Best Row) |
| **Ch5.2.1** | **Shuttle Size Trade-off (Case 1)** | Filter by Best Pump (2000) |
| **Ch5.2.2** | **Pump Speed Trade-off (Case 1)** | Filter by Best Shuttle (2500) |
| **Ch6.1-1** | **Case 2-2 Optimal Decision** | `MILP_scenario_summary_case_2_ulsan.csv` (Best Row) |
| **Ch6.2-1** | **Case 2-1 Optimal Decision** | `MILP_scenario_summary_case_2_yeosu.csv` (Best Row) |

### For `TECHNICAL_DETAILS.md`
| Table ID | Name | Columns | Data Source |
|----------|------|---------|-------------|
| **T3.1** | **Cycle Time Breakdown** | Phase (Loading, Travel, etc.), Duration (hr) | `MILP_per_year_results_case_1.csv` (Best Scenario) |
| **T3.2** | **Cost Breakdown** | Component (Shuttle/Pump/Tank), CAPEX, OPEX | `MILP_scenario_summary_case_1.csv` (Best Row) |
| **T3.3** | **Fleet Expansion** | Year (2030-2050), Demand, Shuttles, Utilization | `MILP_per_year_results_case_1.csv` (Best Scenario) |

---

## 4. Required Figures List

**Status**: Figures 01-15 generated by `visualization_generator.py`
**Output Directory**: `results/figures/`

| Figure ID | Title | Used In | Function |
|-----------|-------|---------|----------|
| **01** | NPC Heatmaps | Strategic (All Cases) | `generate_heatmaps` ✅ |
| **02** | Top 10 Cost Breakdown | Strategic (All Cases) | `generate_top10_breakdown` ✅ |
| **03** | Case Comparison | Executive/Strategic | `generate_case_comparison` ✅ |
| **04** | NPC Distribution | Strategic | `generate_distribution` ✅ |
| **05** | Shuttle Sensitivity | Strategic | `generate_shuttle_sensitivity` ✅ |
| **06** | Cycle Time Breakdown | Technical | `generate_cycle_time_breakdown` ✅ **ADDED** |
| **07** | Pump Sensitivity | Strategic | `generate_pump_sensitivity` ✅ |
| **08** | Cost Pie Charts | Technical | `generate_cost_pie_charts` ✅ |
| **09** | Year Shuttles | Technical | `generate_year_shuttles` ✅ |
| **10** | Year Costs | Technical | `generate_year_costs` ✅ |
| **11** | Case NPC Bars | Executive | `generate_case_npc_bars` ✅ |
| **12** | Operating Metrics | Strategic/Technical | `generate_operating_metrics` ✅ |
| **13** | Cost vs Demand | Technical | `generate_cost_vs_demand` ✅ |
| **14** | Tornado Diagram | Strategic | `generate_tornado_diagram` ✅ |
| **15** | LCOA Comparison | Economic | `generate_lcoa_comparison` ✅ |

---

## 5. Completion Status (v2.4 Report Update)

### Completed Tasks
- ✅ Phase 1: Backup and Preparation
- ✅ Phase 2: Updated Core DOCX Files (Ch1_2, Ch3, Ch4, Appendix)
  - ✅ Ch1_2: Version (2.3→2.4), Discount Rate (7%→0%)
  - ✅ Ch3: Verified (no changes needed)
  - ✅ Ch4: Discount Rate Formula (r=0.07→r=0.0)
  - ✅ Appendix: Verified (no changes needed)
- ✅ Ch5.md & Ch6.md: 3-Layer Analysis (Case 1, Case 2)
- ✅ Ch5.docx & Ch6.docx: Generated from Markdown
- ✅ Phase 3: Remaining Chapters Reviewed
  - Ch7: Code structure (no major changes needed)
  - Ch8_9: Sensitivity analysis review needed (remove discount rate section)
  - Ch10_11: Conclusion verification needed
- ✅ visualization_generator.py: Added Fig 06 (Cycle Time Breakdown)
- ✅ REPORT_GENERATION_PLAN.md: Updated with v2.4 Optimal Solutions

### Remaining Tasks (Optional Follow-up)
- Ch8_9: Rewrite sensitivity analysis (remove discount rate variations)
- Ch10_11: Verify and update conclusions with v2.4 results
- Generate actual NPC values for optimal scenarios table
